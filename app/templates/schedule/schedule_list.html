{% extends "base3.html" %} {% block title %}å›ºå®šã‚¿ã‚¹ã‚¯ä¸€è¦§{% endblock %} {%
block content %}

<div class="sl-page">
  <div class="sl-header">
    <div class="sl-header-top">
      <a href="/main/home" class="sl-back-btn">
        <img
          src="{{ url_for('static', filename='image/back.png') }}"
          alt="æˆ»ã‚‹"
        />
      </a>
      <h1>å›ºå®šã‚¿ã‚¹ã‚¯ä¸€è¦§</h1>
    </div>
    <div class="sl-tab-container">
      <button
        class="sl-tab"
        onclick="location.href='{{ url_for('task.task_list') }}'"
      >
        ã‚¿ã‚¹ã‚¯
      </button>
      <button class="sl-tab active">å›ºå®šã‚¿ã‚¹ã‚¯</button>
    </div>

    <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒãƒƒãƒ—è¡Œ -->
    <div class="sl-filter-chips">
      <!-- ç¹°ã‚Šè¿”ã— -->
      <div class="sl-chip-wrap" data-group="repeat">
        <button class="sl-chip" data-group="repeat">
          <span class="sl-chip-label">ç¹°ã‚Šè¿”ã—</span>
          <span class="sl-chip-arrow">â–¾</span>
        </button>
        <div class="sl-chip-dropdown">
          <button class="sl-chip-opt" data-group="repeat" data-value="æ¯æ—¥">
            æ¯æ—¥
          </button>
          <button class="sl-chip-opt" data-group="repeat" data-value="æ¯é€±">
            æ¯é€±
          </button>
        </div>
      </div>

      <!-- æ™‚é–“å¸¯ -->
      <div class="sl-chip-wrap" data-group="time">
        <button class="sl-chip" data-group="time">
          <span class="sl-chip-label">æ™‚é–“å¸¯</span>
          <span class="sl-chip-arrow">â–¾</span>
        </button>
        <div class="sl-chip-dropdown">
          <button class="sl-chip-opt" data-group="time" data-value="am">
            åˆå‰
          </button>
          <button class="sl-chip-opt" data-group="time" data-value="pm">
            åˆå¾Œ
          </button>
        </div>
      </div>

      <!-- ã‚¿ã‚° -->
      <div class="sl-chip-wrap" data-group="tag">
        <button class="sl-chip" data-group="tag">
          <span class="sl-chip-label">ã‚¿ã‚°</span>
          <span class="sl-chip-arrow">â–¾</span>
        </button>
        <div class="sl-chip-dropdown">
          <button class="sl-chip-opt" data-group="tag" data-value="ä»•äº‹">
            ä»•äº‹
          </button>
          <button class="sl-chip-opt" data-group="tag" data-value="ä¼‘æ†©">
            ä¼‘æ†©
          </button>
          <button class="sl-chip-opt" data-group="tag" data-value="å¥åº·">
            å¥åº·
          </button>
          <button class="sl-chip-opt" data-group="tag" data-value="è¶£å‘³">
            è¶£å‘³
          </button>
        </div>
      </div>

      <!-- æ›œæ—¥ -->
      <div class="sl-chip-wrap" data-group="day">
        <button class="sl-chip" data-group="day">
          <span class="sl-chip-label">æ›œæ—¥</span>
          <span class="sl-chip-arrow">â–¾</span>
        </button>
        <div class="sl-chip-dropdown sl-chip-dropdown--days">
          {% for day in ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥'] %}
          <button
            class="sl-chip-opt sl-chip-opt--day"
            data-group="day"
            data-value="{{ day }}"
          >
            {{ day }}
          </button>
          {% endfor %}
        </div>
      </div>

      <!-- ãƒªã‚»ãƒƒãƒˆ -->
      <button class="sl-chip-reset" id="slFilterReset">ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <!-- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è¡¨ç¤º -->
    <div class="sl-active-filters" id="slActiveFilters"></div>
  </div>

  <div class="sl-task-list">
    {% for task in tasks %}
    <div
      class="sl-task-card"
      data-repeat="{{ task.repeat_type }}"
      data-start="{{ task.start_time }}"
      data-days="{{ task.day_of_week }}"
      data-tag="{{ task.tag }}"
    >
      <div class="sl-task-header">
        <div class="sl-task-title">{{ task.title }}</div>
        <button class="sl-delete-btn" data-task-id="{{ task.id }}">ğŸ—‘</button>
      </div>
      <div class="sl-task-meta">
        <span class="sl-task-category">{{ task.tag }}</span>
        <span class="sl-task-time"
          >{{ task.start_time }}~{{ task.end_time }}</span
        >
        <span class="sl-task-duration">{{ task.duration_min }}åˆ†</span>
      </div>
      {% if task.location %}
      <div class="sl-task-location">
        <span>ğŸ“</span><span>{{ task.location }}</span>
      </div>
      {% endif %}
      <div class="sl-task-repeat-info">
        <span class="sl-repeat-badge">{{ task.repeat_type }}</span>
      </div>
      {% if task.memo %}
      <div class="sl-comment-section">
        <button
          class="sl-comment-toggle collapsed"
          onclick="slToggleComment(this)"
        >
          <span class="sl-arrow">â–¼</span><span>ãƒ¡ãƒ¢</span>
        </button>
        <div class="sl-comment-content hidden">{{ task.memo }}</div>
      </div>
      {% endif %}
      <div class="sl-weekday-pills">
        {% for day in ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥'] %}
        <div
          class="sl-weekday {% if day in task.day_of_week %}active{% endif %}"
        >
          {{ day }}
        </div>
        {% endfor %}
      </div>
    </div>
    {% endfor %}
    <p class="sl-filter-empty" id="slFilterEmpty">è©²å½“ã™ã‚‹ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</p>
  </div>

  {% if tasks|length == 0 %}
  <p class="sl-empty-message">ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</p>
  {% endif %}
  <p class="sl-task-count">ä»¶æ•°ï¼š{{ tasks|length }}</p>

  <button
    class="sl-add-btn"
    onclick="location.href='{{ url_for('schedule.schedule_form') }}'"
  >
    æ–°ã—ã„å›ºå®šã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
  </button>
</div>

<div id="slDeleteModal" class="sl-delete-modal">
  <div class="sl-modal-content">
    <div class="sl-modal-icon">ğŸ—‘ï¸</div>
    <h3 class="sl-modal-title">ã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ</h3>
    <p class="sl-modal-text">ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“</p>
    <div class="sl-modal-btns">
      <button class="sl-modal-btn sl-cancel-btn" onclick="slCloseModal()">
        ã‚­ãƒ£ãƒ³ã‚»ãƒ«
      </button>
      <button class="sl-modal-btn sl-confirm-btn" onclick="slConfirmDelete()">
        å‰Šé™¤ã™ã‚‹
      </button>
    </div>
  </div>
</div>
<script src="{{ url_for('static', filename='js/schedule_list.js') }}"></script>
{% endblock %}
