{% extends "base3.html" %} {% block title %} å›ºå®šã‚¿ã‚¹ã‚¯ä¸€è¦§{% endblock %} {%
block content %}

<div class="header">
  <h1>å›ºå®šã‚¿ã‚¹ã‚¯ä¸€è¦§</h1>
  <div class="tab-container">
    <button class="tab">ã‚¿ã‚¹ã‚¯</button>
    <button class="tab active">å›ºå®šã‚¿ã‚¹ã‚¯</button>
  </div>
</div>

<div class="task-list">
  {% for task in tasks %}
  <div class="task-card">
    <div class="task-header">
      <div class="task-title">{{ task.title }}</div>
      <button class="delete-btn" onclick="deleteTask({{ task.id }})">ğŸ—‘</button>
    </div>
    <div class="task-meta">
      <span class="task-category">{{ task.category }}</span>
      <span class="task-time">{{ task.start_time }}~{{ task.end_time }}</span>
    </div>

    {% if task.comment %}
    <div class="comment-section">
      <button class="comment-toggle" onclick="toggleComment(this)">
        <span class="arrow">â–¼</span>
        <span>ã‚³ãƒ¡ãƒ³ãƒˆ</span>
      </button>
      <div class="comment-content">{{ task.comment }}</div>
    </div>
    {% endif %}

    <div class="weekday-pills">
      {% for day in ['æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ', 'æ—¥'] %}
      <div
        class="weekday {% if day in task.active_days %}active{% else %}inactive{% endif %}"
      >
        {{ day }}
      </div>
      {% endfor %}
    </div>
  </div>
  {% endfor %}
</div>
<button
  class="add-task-btn"
  onclick="location.href='{{ url_for('schedule.schedule_form') }}'"
>
  æ–°ã—ã„å›ºå®šã‚¿ã‚¹ã‚¯ã‚’ä½œæˆ
</button>
{% if tasks|length == 0 %}
<p style="color: red">ã‚¿ã‚¹ã‚¯ãŒã‚ã‚Šã¾ã›ã‚“</p>
{% endif %}
<p>ä»¶æ•°ï¼š{{ tasks|length }}</p>

<script>
  function deleteTask(taskId) {
    if (!confirm("ã“ã®å›ºå®šã‚¿ã‚¹ã‚¯ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;

    const form = document.createElement("form");
    form.method = "POST";
    form.action = `/schedule/delete/${taskId}`;
    document.body.appendChild(form);
    form.submit();
  }
</script>

{% endblock %}
